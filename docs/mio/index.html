<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mio: mio</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">mio<span id="projectnumber">&#160;1.1.0</span>
   </div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
</script>
<div id="main-nav"></div>
<div id="container"><div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">mio </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2mio_2mio_2README"></a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md0"></a>
mio</h1>
<p><a href="https://github.com/maxtek6/mio/actions/workflows/test.yml"><img src="https://github.com/maxtek6/mio/actions/workflows/test.yml/badge.svg" alt="MIO Test Pipeline" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/maxtek6/mio/actions/workflows/doc.yml"><img src="https://github.com/maxtek6/mio/actions/workflows/doc.yml/badge.svg" alt="MIO Docs Pipeline" style="pointer-events: none;" class="inline"/></a></p>
<ul>
<li>Why?<ul>
<li>How to create a mapping</li>
<li>Example</li>
<li>Single Header File</li>
</ul>
</li>
<li>CMake<ul>
<li>Testing</li>
<li>Installation</li>
<li>Subproject Composition</li>
</ul>
</li>
</ul>
<p>This is a fork of the original <a href="https://github.com/vimpunk/mio">repo</a>, which is not actively maintained.</p>
<p>An easy to use header-only cross-platform C++11 memory mapping library with an MIT license.</p>
<p>mio has been created with the goal to be easily includable (i.e. no dependencies) in any C++ project that needs memory mapped file IO without the need to pull in Boost.</p>
<p>Please feel free to open an issue, I'll try to address any concerns as best I can.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
Why?</h2>
<p>Because memory mapping is the best thing since sliced bread!</p>
<p>More seriously, the primary motivation for writing this library instead of using Boost.Iostreams, was the lack of support for establishing a memory mapping with an already open file handle/descriptor. This is possible with mio.</p>
<p>Furthermore, Boost.Iostreams' solution requires that the user pick offsets exactly at page boundaries, which is cumbersome and error prone. mio, on the other hand, manages this internally, accepting any offset and finding the nearest page boundary.</p>
<p>Albeit a minor nitpick, Boost.Iostreams implements memory mapped file IO with a <span class="tt">std::shared_ptr</span> to provide shared semantics, even if not needed, and the overhead of the heap allocation may be unnecessary and/or unwanted. In mio, there are two classes to cover the two use-cases: one that is move-only (basically a zero-cost abstraction over the system specific mmapping functions), and the other that acts just like its Boost.Iostreams counterpart, with shared semantics.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
How to create a mapping</h3>
<blockquote class="doxtable">
<blockquote class="doxtable">
<p>Note : the file must exist before creating a mapping. </p>
</blockquote>
</blockquote>
<p>There are three ways to map a file into memory:</p>
<ul>
<li>Using the constructor, which throws a <span class="tt">std::system_error</span> on failure: <div class="fragment"><div class="line"><a class="code hl_typedef" href="namespacemio.html#a16e95fe46bbad947821a1c4d58c80b84">mio::mmap_source</a> mmap(path, offset, size_to_map);</div>
<div class="ttc" id="anamespacemio_html_a16e95fe46bbad947821a1c4d58c80b84"><div class="ttname"><a href="namespacemio.html#a16e95fe46bbad947821a1c4d58c80b84">mio::mmap_source</a></div><div class="ttdeci">basic_mmap_source&lt; char &gt; mmap_source</div><div class="ttdef"><b>Definition</b> mmap.hpp:445</div></div>
</div><!-- fragment --> or you can omit the <span class="tt">offset</span> and <span class="tt">size_to_map</span> arguments, in which case the entire file is mapped: <div class="fragment"><div class="line"><a class="code hl_typedef" href="namespacemio.html#a16e95fe46bbad947821a1c4d58c80b84">mio::mmap_source</a> mmap(path);</div>
</div><!-- fragment --></li>
<li>Using the factory function: <div class="fragment"><div class="line">std::error_code error;</div>
<div class="line"><a class="code hl_typedef" href="namespacemio.html#a16e95fe46bbad947821a1c4d58c80b84">mio::mmap_source</a> mmap = <a class="code hl_function" href="namespacemio.html#a457598aac30b946c47c282a70d18b029">mio::make_mmap_source</a>(path, offset, size_to_map, error);</div>
<div class="ttc" id="anamespacemio_html_a457598aac30b946c47c282a70d18b029"><div class="ttname"><a href="namespacemio.html#a457598aac30b946c47c282a70d18b029">mio::make_mmap_source</a></div><div class="ttdeci">mmap_source make_mmap_source(const MappingToken &amp;token, mmap_source::size_type offset, mmap_source::size_type length, std::error_code &amp;error)</div><div class="ttdef"><b>Definition</b> mmap.hpp:470</div></div>
</div><!-- fragment --> or: <div class="fragment"><div class="line"><a class="code hl_typedef" href="namespacemio.html#a16e95fe46bbad947821a1c4d58c80b84">mio::mmap_source</a> mmap = <a class="code hl_function" href="namespacemio.html#a457598aac30b946c47c282a70d18b029">mio::make_mmap_source</a>(path, error);</div>
</div><!-- fragment --></li>
<li>Using the <span class="tt">map</span> member function: <div class="fragment"><div class="line">std::error_code error;</div>
<div class="line"><a class="code hl_typedef" href="namespacemio.html#a16e95fe46bbad947821a1c4d58c80b84">mio::mmap_source</a> mmap;</div>
<div class="line">mmap.<a class="code hl_function" href="structmio_1_1basic__mmap.html#a0e0448c6898bfe229e5f6f7f83d9536f">map</a>(path, offset, size_to_map, error);</div>
<div class="ttc" id="astructmio_1_1basic__mmap_html_a0e0448c6898bfe229e5f6f7f83d9536f"><div class="ttname"><a href="structmio_1_1basic__mmap.html#a0e0448c6898bfe229e5f6f7f83d9536f">mio::basic_mmap::map</a></div><div class="ttdeci">void map(const String &amp;path, const size_type &amp;offset, const size_type &amp;length, std::error_code &amp;error)</div></div>
</div><!-- fragment --> or: <div class="fragment"><div class="line">mmap.<a class="code hl_function" href="structmio_1_1basic__mmap.html#a0e0448c6898bfe229e5f6f7f83d9536f">map</a>(path, error);</div>
</div><!-- fragment --> <blockquote class="doxtable">
<blockquote class="doxtable">
<p><b>Note:</b> The constructors <b>require</b> exceptions to be enabled. If you prefer to build your projects with <span class="tt">-fno-exceptions</span>, you can still use the other ways. </p>
</blockquote>
</blockquote>
</li>
</ul>
<p>Moreover, in each case, you can provide either some string type for the file's path, or you can use an existing, valid file handle.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mmap_8hpp.html">mio/mmap.hpp</a>&gt;</span></div>
<div class="line"><span class="comment">// #include &lt;mio/mio.hpp&gt; if using single header</span></div>
<div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// NOTE: error handling omitted for brevity.</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> fd = open(<span class="stringliteral">&quot;file.txt&quot;</span>, O_RDONLY);</div>
<div class="line">    <a class="code hl_typedef" href="namespacemio.html#a16e95fe46bbad947821a1c4d58c80b84">mio::mmap_source</a> mmap(fd, 0, <a class="code hl_enumvalue" href="namespacemio.html#a171b79c926b315b6939b206ad64869f5af46f1a6ab1149ea0286c9d7ff8a36338">mio::map_entire_file</a>);</div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">}</div>
<div class="ttc" id="ammap_8hpp_html"><div class="ttname"><a href="mmap_8hpp.html">mmap.hpp</a></div></div>
<div class="ttc" id="anamespacemio_html_a171b79c926b315b6939b206ad64869f5af46f1a6ab1149ea0286c9d7ff8a36338"><div class="ttname"><a href="namespacemio.html#a171b79c926b315b6939b206ad64869f5af46f1a6ab1149ea0286c9d7ff8a36338">mio::map_entire_file</a></div><div class="ttdeci">@ map_entire_file</div><div class="ttdef"><b>Definition</b> mmap.hpp:68</div></div>
</div><!-- fragment --><p> However, mio does not check whether the provided file descriptor has the same access permissions as the desired mapping, so the mapping may fail. Such errors are reported via the <span class="tt">std::error_code</span> out parameter that is passed to the mapping function.</p>
<p><b>WINDOWS USERS</b>: This library <em>does</em> support the use of wide character types for functions where character strings are expected (e.g. path parameters).</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
Example</h3>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="mio_8hpp.html">mio.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> handle_error(<span class="keyword">const</span> std::error_code&amp; error);</div>
<div class="line"><span class="keywordtype">void</span> allocate_file(<span class="keyword">const</span> std::string&amp; path, <span class="keyword">const</span> <span class="keywordtype">int</span> size);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> path = <span class="stringliteral">&quot;file.txt&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// NOTE: mio does *not* create the file for you if it doesn&#39;t exist! You</span></div>
<div class="line">    <span class="comment">// must ensure that the file exists before establishing a mapping. It</span></div>
<div class="line">    <span class="comment">// must also be non-empty. So for illustrative purposes the file is</span></div>
<div class="line">    <span class="comment">// created now.</span></div>
<div class="line">    allocate_file(path, 155);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Read-write memory map the whole file by using `map_entire_file` where the</span></div>
<div class="line">    <span class="comment">// length of the mapping is otherwise expected, with the factory method.</span></div>
<div class="line">    std::error_code error;</div>
<div class="line">    <a class="code hl_typedef" href="namespacemio.html#aa24db79bbb437bf26eba583385c9a9cc">mio::mmap_sink</a> rw_mmap = <a class="code hl_function" href="namespacemio.html#af5d7d6f67041bd9fbae1ef0fe250b60d">mio::make_mmap_sink</a>(</div>
<div class="line">            path, 0, <a class="code hl_enumvalue" href="namespacemio.html#a171b79c926b315b6939b206ad64869f5af46f1a6ab1149ea0286c9d7ff8a36338">mio::map_entire_file</a>, error);</div>
<div class="line">    <span class="keywordflow">if</span> (error) { <span class="keywordflow">return</span> handle_error(error); }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// You can use any iterator based function.</span></div>
<div class="line">    std::fill(rw_mmap.<a class="code hl_function" href="structmio_1_1basic__mmap.html#a84ebe9e1875ad27851748a9674defcda">begin</a>(), rw_mmap.<a class="code hl_function" href="structmio_1_1basic__mmap.html#a0e1f53d27ffb84277897a1d1039c5708">end</a>(), <span class="charliteral">&#39;a&#39;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Or manually iterate through the mapped region just as if it were any other </span></div>
<div class="line">    <span class="comment">// container, and change each byte&#39;s value (since this is a read-write mapping).</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; b : rw_mmap) {</div>
<div class="line">        b += 10;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Or just change one value with the subscript operator.</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> answer_index = rw_mmap.size() / 2;</div>
<div class="line">    rw_mmap[answer_index] = 42;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Don&#39;t forget to flush changes to disk before unmapping. However, if</span></div>
<div class="line">    <span class="comment">// `rw_mmap` were to go out of scope at this point, the destructor would also</span></div>
<div class="line">    <span class="comment">// automatically invoke `sync` before `unmap`.</span></div>
<div class="line">    rw_mmap.sync(error);</div>
<div class="line">    <span class="keywordflow">if</span> (error) { <span class="keywordflow">return</span> handle_error(error); }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We can then remove the mapping, after which rw_mmap will be in a default</span></div>
<div class="line">    <span class="comment">// constructed state, i.e. this and the above call to `sync` have the same</span></div>
<div class="line">    <span class="comment">// effect as if the destructor had been invoked.</span></div>
<div class="line">    rw_mmap.unmap();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now create the same mapping, but in read-only mode. Note that calling the</span></div>
<div class="line">    <span class="comment">// overload without the offset and file length parameters maps the entire</span></div>
<div class="line">    <span class="comment">// file.</span></div>
<div class="line">    <a class="code hl_typedef" href="namespacemio.html#a16e95fe46bbad947821a1c4d58c80b84">mio::mmap_source</a> ro_mmap;</div>
<div class="line">    ro_mmap.<a class="code hl_function" href="structmio_1_1basic__mmap.html#a0e0448c6898bfe229e5f6f7f83d9536f">map</a>(path, error);</div>
<div class="line">    <span class="keywordflow">if</span> (error) { <span class="keywordflow">return</span> handle_error(error); }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> the_answer_to_everything = ro_mmap[answer_index];</div>
<div class="line">    assert(the_answer_to_everything == 42);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> handle_error(<span class="keyword">const</span> std::error_code&amp; error)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; errmsg = error.message();</div>
<div class="line">    std::printf(<span class="stringliteral">&quot;error mapping file: %s, exiting...\n&quot;</span>, errmsg.c_str());</div>
<div class="line">    <span class="keywordflow">return</span> error.value();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> allocate_file(<span class="keyword">const</span> std::string&amp; path, <span class="keyword">const</span> <span class="keywordtype">int</span> size)</div>
<div class="line">{</div>
<div class="line">    std::ofstream file(path);</div>
<div class="line">    std::string s(size, <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line">    file &lt;&lt; s;</div>
<div class="line">}</div>
<div class="ttc" id="amio_8hpp_html"><div class="ttname"><a href="mio_8hpp.html">mio.hpp</a></div></div>
<div class="ttc" id="anamespacemio_html_aa24db79bbb437bf26eba583385c9a9cc"><div class="ttname"><a href="namespacemio.html#aa24db79bbb437bf26eba583385c9a9cc">mio::mmap_sink</a></div><div class="ttdeci">basic_mmap_sink&lt; char &gt; mmap_sink</div><div class="ttdef"><b>Definition</b> mmap.hpp:448</div></div>
<div class="ttc" id="anamespacemio_html_af5d7d6f67041bd9fbae1ef0fe250b60d"><div class="ttname"><a href="namespacemio.html#af5d7d6f67041bd9fbae1ef0fe250b60d">mio::make_mmap_sink</a></div><div class="ttdeci">mmap_sink make_mmap_sink(const MappingToken &amp;token, mmap_sink::size_type offset, mmap_sink::size_type length, std::error_code &amp;error)</div><div class="ttdef"><b>Definition</b> mmap.hpp:488</div></div>
<div class="ttc" id="astructmio_1_1basic__mmap_html_a0e1f53d27ffb84277897a1d1039c5708"><div class="ttname"><a href="structmio_1_1basic__mmap.html#a0e1f53d27ffb84277897a1d1039c5708">mio::basic_mmap::end</a></div><div class="ttdeci">iterator end() noexcept</div><div class="ttdef"><b>Definition</b> mmap.hpp:245</div></div>
<div class="ttc" id="astructmio_1_1basic__mmap_html_a84ebe9e1875ad27851748a9674defcda"><div class="ttname"><a href="structmio_1_1basic__mmap.html#a84ebe9e1875ad27851748a9674defcda">mio::basic_mmap::begin</a></div><div class="ttdeci">iterator begin() noexcept</div><div class="ttdef"><b>Definition</b> mmap.hpp:233</div></div>
</div><!-- fragment --><p><span class="tt"><a class="el" href="structmio_1_1basic__mmap.html">mio::basic_mmap</a></span> is move-only, but if multiple copies to the same mapping are needed, use <span class="tt"><a class="el" href="classmio_1_1basic__shared__mmap.html">mio::basic_shared_mmap</a></span> which has <span class="tt">std::shared_ptr</span> semantics and has the same interface as <span class="tt"><a class="el" href="structmio_1_1basic__mmap.html">mio::basic_mmap</a></span>. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="shared__mmap_8hpp.html">mio/shared_mmap.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespacemio.html#abfdbe8a7a9bad7666e05cb2f774df6fd">mio::shared_mmap_source</a> shared_mmap1(<span class="stringliteral">&quot;path&quot;</span>, offset, size_to_map);</div>
<div class="line"><a class="code hl_typedef" href="namespacemio.html#abfdbe8a7a9bad7666e05cb2f774df6fd">mio::shared_mmap_source</a> shared_mmap2(std::move(mmap1)); <span class="comment">// or use operator=</span></div>
<div class="line"><a class="code hl_typedef" href="namespacemio.html#abfdbe8a7a9bad7666e05cb2f774df6fd">mio::shared_mmap_source</a> shared_mmap3(std::make_shared&lt;mio::mmap_source&gt;(mmap1)); <span class="comment">// or use operator=</span></div>
<div class="line"><a class="code hl_typedef" href="namespacemio.html#abfdbe8a7a9bad7666e05cb2f774df6fd">mio::shared_mmap_source</a> shared_mmap4;</div>
<div class="line">shared_mmap4.<a class="code hl_function" href="classmio_1_1basic__shared__mmap.html#a80be05fbd97eb1ddf5a9572633a05c6e">map</a>(<span class="stringliteral">&quot;path&quot;</span>, offset, size_to_map, error);</div>
<div class="ttc" id="aclassmio_1_1basic__shared__mmap_html_a80be05fbd97eb1ddf5a9572633a05c6e"><div class="ttname"><a href="classmio_1_1basic__shared__mmap.html#a80be05fbd97eb1ddf5a9572633a05c6e">mio::basic_shared_mmap::map</a></div><div class="ttdeci">void map(const String &amp;path, const size_type &amp;offset, const size_type &amp;length, std::error_code &amp;error)</div><div class="ttdef"><b>Definition</b> shared_mmap.hpp:269</div></div>
<div class="ttc" id="anamespacemio_html_abfdbe8a7a9bad7666e05cb2f774df6fd"><div class="ttname"><a href="namespacemio.html#abfdbe8a7a9bad7666e05cb2f774df6fd">mio::shared_mmap_source</a></div><div class="ttdeci">basic_shared_mmap_source&lt; char &gt; shared_mmap_source</div><div class="ttdef"><b>Definition</b> shared_mmap.hpp:414</div></div>
<div class="ttc" id="ashared__mmap_8hpp_html"><div class="ttname"><a href="shared__mmap_8hpp.html">shared_mmap.hpp</a></div></div>
</div><!-- fragment --><p>It's possible to define the type of a byte (which has to be the same width as <span class="tt">char</span>), though aliases for the most common ones are provided by default: </p><div class="fragment"><div class="line"><span class="keyword">using </span>mmap_source = basic_mmap_source&lt;char&gt;;</div>
<div class="line"><span class="keyword">using </span>ummap_source = basic_mmap_source&lt;unsigned char&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span>mmap_sink = basic_mmap_sink&lt;char&gt;;</div>
<div class="line"><span class="keyword">using </span>ummap_sink = basic_mmap_sink&lt;unsigned char&gt;;</div>
</div><!-- fragment --><p> But it may be useful to define your own types, say when using the new <span class="tt">std::byte</span> type in C++17: </p><div class="fragment"><div class="line"><span class="keyword">using </span>mmap_source = <a class="code hl_typedef" href="namespacemio.html#ad7755f189827a4845ed33ef075f884ba">mio::basic_mmap_source&lt;std::byte&gt;</a>;</div>
<div class="line"><span class="keyword">using </span>mmap_sink = <a class="code hl_typedef" href="namespacemio.html#a7a97516e4420e05ee38fff7e48461e0c">mio::basic_mmap_sink&lt;std::byte&gt;</a>;</div>
<div class="ttc" id="anamespacemio_html_a7a97516e4420e05ee38fff7e48461e0c"><div class="ttname"><a href="namespacemio.html#a7a97516e4420e05ee38fff7e48461e0c">mio::basic_mmap_sink</a></div><div class="ttdeci">basic_mmap&lt; access_mode::write, ByteT &gt; basic_mmap_sink</div><div class="ttdef"><b>Definition</b> mmap.hpp:439</div></div>
<div class="ttc" id="anamespacemio_html_ad7755f189827a4845ed33ef075f884ba"><div class="ttname"><a href="namespacemio.html#ad7755f189827a4845ed33ef075f884ba">mio::basic_mmap_source</a></div><div class="ttdeci">basic_mmap&lt; access_mode::read, ByteT &gt; basic_mmap_source</div><div class="ttdef"><b>Definition</b> mmap.hpp:432</div></div>
</div><!-- fragment --><p>Though generally not needed, since mio maps users requested offsets to page boundaries, you can query the underlying system's page allocation granularity by invoking <span class="tt"><a class="el" href="namespacemio.html#a5fa19e76f930339fbeb51ad691b0bfd3">mio::page_size()</a></span>, which is located in <span class="tt"><a class="el" href="page_8hpp.html">mio/page.hpp</a></span>.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
Single Header File</h3>
<p>Mio can be added to your project as a single header file simply by including <span class="tt">\single_include\<a class="el" href="namespacemio.html">mio</a>\<a class="el" href="mio_8hpp.html">mio.hpp</a></span>. Single header files can be regenerated at any time by running the <span class="tt">amalgamate.py</span> script within <span class="tt">\third_party</span>. <br  />
</p>
<div class="fragment"><div class="line">python amalgamate.py -c config.json -s ../include</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
CMake</h2>
<p>As a header-only library, mio has no compiled components. Nevertheless, a <a href="https://cmake.org/overview/">CMake</a> build system is provided to allow easy testing, installation, and subproject composition on many platforms and operating systems.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
Testing</h3>
<p>Mio is distributed with a small suite of tests and examples. When mio is configured as the highest level CMake project, this suite of executables is built by default. Mio's test executables are integrated with the CMake test driver program, <a href="https://cmake.org/cmake/help/latest/manual/ctest.1.html">CTest</a>.</p>
<p>CMake supports a number of backends for compilation and linking.</p>
<p>To use a static configuration build tool, such as GNU Make or Ninja:</p>
<div class="fragment"><div class="line">cd &lt;mio source directory&gt;</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line"> </div>
<div class="line"># Configure the build</div>
<div class="line">cmake -D CMAKE_BUILD_TYPE=&lt;Debug | Release&gt; \</div>
<div class="line">      -G &lt;&quot;Unix Makefiles&quot; | &quot;Ninja&quot;&gt; ..</div>
<div class="line"> </div>
<div class="line"># build the tests</div>
<div class="line">&lt; make | ninja | cmake --build . &gt;</div>
<div class="line"> </div>
<div class="line"># run the tests</div>
<div class="line">&lt; make test | ninja test | cmake --build . --target test | ctest &gt;</div>
</div><!-- fragment --><p>To use a dynamic configuration build tool, such as Visual Studio or Xcode:</p>
<div class="fragment"><div class="line">cd &lt;mio source directory&gt;</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line"> </div>
<div class="line"># Configure the build</div>
<div class="line">cmake -G &lt;&quot;Visual Studio 14 2015 Win64&quot; | &quot;Xcode&quot;&gt; ..</div>
<div class="line"> </div>
<div class="line"># build the tests</div>
<div class="line">cmake --build . --config &lt;Debug | Release&gt;</div>
<div class="line"> </div>
<div class="line"># run the tests via ctest...</div>
<div class="line">ctest --build-config &lt;Debug | Release&gt;</div>
<div class="line"> </div>
<div class="line"># ... or via CMake build tool mode...</div>
<div class="line">cmake --build . --config &lt;Debug | Release&gt; --target test</div>
</div><!-- fragment --><p>Of course the <b>build</b> and <b>test</b> steps can also be executed via the <b>all</b> and <b>test</b> targets, respectively, from within the IDE after opening the project file generated during the configuration step.</p>
<p>Mio's testing is also configured to operate as a client to the <a href="https://www.cdash.org/">CDash</a> software quality dashboard application. Please see the <a href="https://cmake.org/cmake/help/latest/manual/ctest.1.html#dashboard-client">Kitware documentation</a> for more information on this mode of operation.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
Installation</h3>
<p>Mio's build system provides an installation target and support for downstream consumption via CMake's <a href="https://cmake.org/cmake/help/v3.0/command/find_package.html"><span class="tt">find_package</span></a> intrinsic function. CMake allows installation to an arbitrary location, which may be specified by defining <span class="tt">CMAKE_INSTALL_PREFIX</span> at configure time. In the absense of a user specification, CMake will install mio to conventional location based on the platform operating system.</p>
<p>To use a static configuration build tool, such as GNU Make or Ninja:</p>
<div class="fragment"><div class="line">cd &lt;mio source directory&gt;</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line"> </div>
<div class="line"># Configure the build</div>
<div class="line">cmake [-D CMAKE_INSTALL_PREFIX=&quot;path/to/installation&quot;] \</div>
<div class="line">      [-D BUILD_TESTING=False]                         \</div>
<div class="line">      -D CMAKE_BUILD_TYPE=Release                      \</div>
<div class="line">      -G &lt;&quot;Unix Makefiles&quot; | &quot;Ninja&quot;&gt; ..</div>
<div class="line"> </div>
<div class="line"># install mio</div>
<div class="line">&lt;make install | ninja install | cmake --build . --target install&gt;</div>
</div><!-- fragment --><p>To use a dynamic configuration build tool, such as Visual Studio or Xcode:</p>
<div class="fragment"><div class="line">cd &lt;mio source directory&gt;</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line"> </div>
<div class="line"># Configure the project</div>
<div class="line">cmake [-D CMAKE_INSTALL_PREFIX=&quot;path/to/installation&quot;] \</div>
<div class="line">      [-D BUILD_TESTING=False]                         \</div>
<div class="line">      -G &lt;&quot;Visual Studio 14 2015 Win64&quot; | &quot;Xcode&quot;&gt; ..</div>
<div class="line"> </div>
<div class="line"># install mio</div>
<div class="line">cmake --build . --config Release --target install</div>
</div><!-- fragment --><p>Note that the last command of the installation sequence may require administrator privileges (e.g. <span class="tt">sudo</span>) if the installation root directory lies outside your home directory.</p>
<p>This installation</p><ul>
<li>copies the mio header files to the <span class="tt">include/mio</span> subdirectory of the installation root</li>
<li>generates and copies several CMake configuration files to the <span class="tt">share/cmake/mio</span> subdirectory of the installation root</li>
</ul>
<p>This latter step allows downstream CMake projects to consume mio via <span class="tt">find_package</span>, e.g.</p>
<div class="fragment"><div class="line">find_package( mio REQUIRED )</div>
<div class="line">target_link_libraries( MyTarget PUBLIC mio::mio )</div>
</div><!-- fragment --><p><b>WINDOWS USERS</b>: The <span class="tt">mio::mio</span> target <span class="tt">#define</span>s <span class="tt">WIN32_LEAN_AND_MEAN</span> and <span class="tt">NOMINMAX</span>. The former ensures the imported surface area of the Win API is minimal, and the latter disables Windows' <span class="tt">min</span> and <span class="tt">max</span> macros so they don't intefere with <span class="tt">std::min</span> and <span class="tt">std::max</span>. Because <em>mio</em> is a header only library, these defintions will leak into downstream CMake builds. If their presence is causing problems with your build then you can use the alternative <span class="tt">mio::mio_full_winapi</span> target, which adds none of these defintions.</p>
<p>If mio was installed to a non-conventional location, it may be necessary for downstream projects to specify the mio installation root directory via either</p>
<ul>
<li>the <span class="tt">CMAKE_PREFIX_PATH</span> configuration option,</li>
<li>the <span class="tt">CMAKE_PREFIX_PATH</span> environment variable, or</li>
<li><span class="tt">mio_DIR</span> environment variable.</li>
</ul>
<p>Please see the <a href="https://cmake.org/cmake/help/v3.0/command/find_package.html">Kitware documentation</a> for more information.</p>
<p>In addition, mio supports packaged relocatable installations via <a href="https://cmake.org/cmake/help/latest/manual/cpack.1.html">CPack</a>. Following configuration, from the build directory, invoke cpack as follows to generate a packaged installation:</p>
<div class="fragment"><div class="line">cpack -G &lt;generator name&gt; -C Release</div>
</div><!-- fragment --><p>The list of supported generators varies from platform to platform. See the output of <span class="tt">cpack --help</span> for a complete list of supported generators on your platform.</p>
<h3 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
Subproject Composition</h3>
<p>To use mio as a subproject, copy the mio repository to your project's dependencies/externals folder. If your project is version controlled using git, a git submodule or git subtree can be used to syncronize with the updstream repository. The <a href="https://services.github.com/on-demand/downloads/submodule-vs-subtree-cheat-sheet/">use</a> and <a href="https://andrey.nering.com.br/2016/git-submodules-vs-subtrees/">relative advantages</a> of these git facilities is beyond the scope of this document, but in brief, each may be established as follows:</p>
<div class="fragment"><div class="line"># via git submodule</div>
<div class="line">cd &lt;my project&#39;s dependencies directory&gt;</div>
<div class="line">git submodule add -b master https://github.com/maxtek6/mio.git</div>
<div class="line"> </div>
<div class="line"># via git subtree</div>
<div class="line">cd &lt;my project&#39;s root directory&gt;</div>
<div class="line">git subtree add --prefix &lt;path/to/dependencies&gt;/mio       \</div>
<div class="line">    https://github.com/maxtek6/mio.git master --squash</div>
</div><!-- fragment --><p>Given a mio subdirectory in a project, simply add the following lines to your project's to add mio include directories to your target's include path.</p>
<div class="fragment"><div class="line">add_subdirectory( path/to/mio/ )</div>
<div class="line">target_link_libraries( MyTarget PUBLIC &lt;mio::mio | mio&gt; )</div>
</div><!-- fragment --><p>Note that, as a subproject, mio's tests and examples will not be built and CPack integration is deferred to the host project. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
